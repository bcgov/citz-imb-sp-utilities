(this["webpackJsonpcitz-imb-sp-utilities"]=this["webpackJsonpcitz-imb-sp-utilities"]||[]).push([[0],[function(e,t,i){e.exports=i(1)},function(e,t,i){"use strict";i.r(t),i.d(t,"GetContextWebInformation",(function(){return n})),i.d(t,"GetFormDigestValue",(function(){return c})),i.d(t,"SendEmail",(function(){return u})),i.d(t,"AddUsersToGroup",(function(){return a})),i.d(t,"ChangeGroupOwner",(function(){return d})),i.d(t,"CreateGroup",(function(){return l})),i.d(t,"DeleteGroup",(function(){return f})),i.d(t,"GetAssociatedGroups",(function(){return m})),i.d(t,"GetGroup",(function(){return p})),i.d(t,"GetGroupMembers",(function(){return w})),i.d(t,"RemoveUsersFromGroup",(function(){return h})),i.d(t,"GetList",(function(){return v})),i.d(t,"GetListFields",(function(){return P})),i.d(t,"GetListItems",(function(){return G})),i.d(t,"CreateList",(function(){return b})),i.d(t,"DeleteList",(function(){return I})),i.d(t,"AddItemsToList",(function(){return g})),i.d(t,"RemoveItemsFromList",(function(){return L})),i.d(t,"UpdateListItem",(function(){return y})),i.d(t,"AddPermissionsToList",(function(){return _})),i.d(t,"AddPermissionsToSite",(function(){return U})),i.d(t,"BreakListPermissionsInheritance",(function(){return D})),i.d(t,"BreakSitePermissionsInheritance",(function(){return A})),i.d(t,"GetListPermissions",(function(){return N})),i.d(t,"GetSitePermissions",(function(){return q})),i.d(t,"RemovePermissionsFromList",(function(){return F})),i.d(t,"RemovePermissionsFromSite",(function(){return R})),i.d(t,"ResetSitePermissionsInheritance",(function(){return S})),i.d(t,"GetSite",(function(){return T})),i.d(t,"GetRoleDefinitions",(function(){return j})),i.d(t,"GetCurrentUser",(function(){return V})),i.d(t,"GetUser",(function(){return x})),i.d(t,"GetUserGroups",(function(){return B})),i.d(t,"Search",(function(){return C})),i.d(t,"AddListViewField",(function(){return $})),i.d(t,"GetListDefaultView",(function(){return k})),i.d(t,"GetListViews",(function(){return E})),i.d(t,"RemoveListViewAllFields",(function(){return M})),i.d(t,"RemoveListViewField",(function(){return O})),i.d(t,"SetListViewFieldIndex",(function(){return W}));var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""===e){if("undefined"===typeof _spPageContextInfo)return Promise.reject("GetContextWebInformation:: _spPageContextInfo is not defined");e=_spPageContextInfo.siteAbsoluteUrl}return new Promise((function(t,i){fetch("".concat(e,"/_api/contextinfo"),{method:"post",headers:{Accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"}}).then((function(e){e.ok?e.json().then((function(e){t(e.d.GetContextWebInformation)})).catch((function(e){console.log(e)})):i("GetContextWebInformation::".concat(e.status," ").concat(e.statusText))})).catch((function(e){i("GetContextWebInformation::".concat(e))}))}))},o=function(e,t,i){return new Promise((function(n,o){fetch("".concat(e).concat(t),i).then((function(e){e.ok?204===e.status?n():304===e.status?(console.warning("".concat(e.status," ").concat(e.statusText," ").concat(t)),n(e.json())):n(e.json()):o("".concat(e.status," ").concat(e.statusText))}))}))},r=function(e){var t=e.url,i=void 0===t?"":t,n=e.endPoint,r=e.method,s=void 0===r?"get":r,u=e.body,a=void 0===u?"":u,d=e.headers,l=e.cache;if(""===i){if("undefined"===typeof _spPageContextInfo)return Promise.reject("RestCall:: _spPageContextInfo is not defined");i=_spPageContextInfo.webAbsoluteUrl}var f={method:s};return"string"!==typeof a?f.body=JSON.stringify(a):""!==a&&(f.body=a),f.headers=d||{Accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},l?f.cache=l:"get"===s&&(f.headers["Cache-Control"]="no-cache",f.headers.Pragma="no-cache"),new Promise((function(e,t){switch(f.method.toLowerCase()){case"post":c(i).then((function(r){f.headers["X-RequestDigest"]=r,o(i,n,f).then((function(t){e(t)})).catch((function(e){console.warn("options",f),t(e)}))}));break;case"merge":c(i).then((function(r){f.headers["X-RequestDigest"]=r,f.headers["X-HTTP-Method"]="MERGE",f.headers["If-Match"]="*",f.method="post",o(i,n,f).then((function(t){e(t)})).catch((function(e){console.warn("options",f),t(e)}))}));break;default:o(i,n,f).then((function(t){e(t)})).catch((function(e){console.warn("options",f),t(e)}))}}))},s=function(e){if(!e)return!1;"{"===e[0]&&(e=e.substring(1,e.length-1));return/^(\{){0,1}[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(e)},c=function(){return new Promise((function(e,t){n("").then((function(t){e(t.FormDigestValue)})).catch((function(e){t("GetFormDigestValue::".concat(e))}))}))},u=function(e){var t=e.baseurl,i=void 0===t?"":t,n=e.to,o=e.from,s=e.cc,c=void 0===s?[]:s,u=e.bcc,a=void 0===u?[]:u,d=e.subject,l=e.body;if(!n)return new Promise((function(e,t){t("SendEmail requires to")}));if(Array.isArray(n)||(n=[n]),!d)return new Promise((function(e,t){t("SendEmail requires subject")}));if(!l)return new Promise((function(e,t){t("SendEmail requires body")}));var f={properties:{__metadata:{type:"SP.Utilities.EmailProperties"},To:{results:n},Body:l,Subject:d,CC:{results:c},BCC:{results:a}}};o&&(f.properties.From=o);return new Promise((function(e,t){r({url:i,endPoint:"/_api/SP.Utilities.Utility.SendEmail",method:"post",body:f}).then((function(t){e(t.d)})).catch((function(e){t("SendEmail::".concat(e))}))}))},a=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.groupId,s=e.groupName,c=e.loginName;if(!c)return Promise.reject("AddUsersToGroup requires loginName");if(Array.isArray(c)||(c=[c]),o)t="/_api/web/SiteGroups(".concat(o,")/Users");else{if(!s)return Promise.reject("AddUsersToGroup requires GroupId or GroupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')/Users(").concat(c,")")}return new Promise((function(e,i){for(var o=[],s=0;s<c.length;s++)o.push(r({url:n,endPoint:t,method:"post",body:{__metadata:{type:"SP.User"},LoginName:c[s]},headers:{accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"}}));Promise.all(o).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){i("AddUsersToGroup::".concat(e))}))}))},d=function(e){var t,i,n,o=e.baseurl,r=void 0===o?"":o,s=e.groupId,c=e.groupName,u=e.ownerGroupId,a=e.ownerGroupName;if("undefined"===typeof SP)return Promise.reject("ChangeGroupOwner:: SP is undefined");if(t=""===r?new SP.ClientContext:new SP.ClientContext(r),s)i=t.get_web().get_siteGroups().getById(s);else{if(!c)return Promise.reject("ChangeGroupOwner requires groupId or groupName");i=t.get_web().get_siteGroups().getByName(c)}if(u)n=t.get_web().get_siteGroups().getById(u);else{if(!a)return Promise.reject("ChangeGroupOwner requires ownerGroupId or ownerGroupName");n=t.get_web().get_siteGroups().getByName(a)}return new Promise((function(e,o){i.set_owner(n),i.update(),t.executeQueryAsync((function(){e()}),(function(e){o("ChangeGroupOwner::".concat(e))}))}))},l=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.groupName,s=e.groupDescription,c={__metadata:{type:"SP.Group"},Description:void 0===s?"":s,Title:o};return o?(t="/_api/web/SiteGroups",new Promise((function(e,i){r({url:n,endPoint:t,method:"post",body:c}).then((function(t){e(t.d)})).catch((function(e){i("CreateGroup::".concat(e))}))}))):Promise.reject("CreateGroup requires GroupName")},f=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.groupName,s=e.groupId;if(s)t="/_api/web/SiteGroups/removebyid('".concat(s,"')");else{if(!o)return Promise.reject("DeleteGroup requires groupId or groupName");t="/_api/web/SiteGroups/removebyloginname('".concat(o,"')")}return new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("DeleteGroup::".concat(e))}))}))},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise((function(t,i){Promise.all([r({url:e,endPoint:"/_api/Web/AssociatedOwnerGroup"}),r({url:e,endPoint:"/_api/Web/AssociatedMemberGroup"}),r({url:e,endPoint:"/_api/Web/AssociatedVisitorGroup"})]).then((function(e){t({AssociatedOwnerGroup:e[0].d,AssociatedMemberGroup:e[1].d,AssociatedVisitorGroup:e[2].d})})).catch((function(e){i("GetAssociatedGroups::".concat(e))}))}))},p=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.groupId,s=e.groupName;if(o)t="/_api/web/SiteGroups(".concat(o,")");else{if(!s)return Promise.reject("GetGroup requires GroupId or GroupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')")}return new Promise((function(e,i){r({url:n,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){i("GetGroup::".concat(e))}))}))},w=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.groupId,s=e.groupName;if(o)t="/_api/web/SiteGroups(".concat(o,")/Users");else{if(!s)return Promise.reject("GetGroupMembers requires groupId or groupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')/Users")}return new Promise((function(e,i){r({url:n,endPoint:t}).then((function(t){e(t.d.results)})).catch((function(e){i("GetGroupMembers::".concat(e))}))}))},h=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.groupId,s=e.groupName,c=e.loginName,u=e.userId;if(o)t="/_api/web/SiteGroups(".concat(o,")/Users");else{if(!s)return Promise.reject("RemoveUsersFromGroup requires GroupId or GroupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')/Users")}if(c)Array.isArray(c)||(u=[c]);else{if(!u)return Promise.reject("RemoveUserFromGroup requires userId or logonName");Array.isArray(u)||(u=[u])}return new Promise((function(e,i){var o=[];if(c)for(var s=0;s<c.length;s++)o.push(r({url:n,endPoint:"".concat(t,"/removeByLoginName('").concat(c[s],"')"),method:"post"}));else for(var a=0;a<u.length;a++)o.push(r({url:n,endPoint:"".concat(t,"/removeByID(").concat(u[a],")"),method:"post"}));Promise.all(o).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){i("RemoveUsersFromGroup::".concat(e))}))}))},v=function(e){var t,i,n,o="",c="",u="",a="";if(!e)return Promise.reject("GetList requires listGUID or listName");if(s(e))i=e;else if("string"===typeof e)t=e;else{var d=e.baseurl;o=void 0===d?"":d,t=e.listName,i=e.listGUID;var l=e.expand;c=void 0===l?"":l;var f=e.filter;u=void 0===f?"":f;var m=e.select;a=void 0===m?"":m}var p="?$expand=FirstUniqueAncestorSecurableObject,RootFolder";if(c&&(p+=",".concat(c)),u&&(p+="&$filter=".concat(u)),a&&(p+="&$select=".concat(a)),i)n="/_api/web/Lists('".concat(i,"')").concat(p);else{if(!t)return Promise.reject("GetList requires listGUID or listName");n="/_api/web/Lists/getByTitle('".concat(t,"')").concat(p)}return new Promise((function(e,t){r({url:o,endPoint:n}).then((function(t){e(t.d)})).catch((function(e){t("GetList::".concat(e))}))}))},P=function(e){var t,i,n,o="",c="",u="",a="";if(!e)return Promise.reject("GetListFields requires listGUID or listName");if(s(e))i=e;else if("string"===typeof e)t=e;else{var d=e.baseurl;o=void 0===d?"":d,t=e.listName,i=e.listGUID;var l=e.expand;c=void 0===l?"":l;var f=e.filter;u=void 0===f?"":f;var m=e.select;a=void 0===m?"":m}if(i)n="/_api/web/Lists('".concat(i,"')/Fields");else{if(!t)return new Promise((function(e,t){t("GetListFields requires listGUID or listName")}));n="/_api/web/Lists/getByTitle('".concat(t,"')/Fields")}var p=[];return c&&p.push("$expand=".concat(c)),u&&p.push("$filter=".concat(u)),a&&p.push("$select=".concat(a)),p.length&&(n+="?".concat(p.join("&"))),new Promise((function(e,t){r({url:o,endPoint:n}).then((function(t){e(t.d.results)})).catch((function(e){t("GetListFields::".concat(e))}))}))},G=function(e){var t,i,n,o="",c="",u="",a="";if(!e)return Promise.reject("GetListFields requires listGUID or listName");if(s(e))i=e;else if("string"===typeof e)t=e;else{var d=e.baseurl;o=void 0===d?"":d,t=e.listName,i=e.listGUID;var l=e.expand;c=void 0===l?"":l;var f=e.filter;u=void 0===f?"":f;var m=e.select;a=void 0===m?"":m}if(i)n="/_api/web/Lists('".concat(i,"')/items");else{if(!t)return new Promise((function(e,t){t("GetList requires listGUID or listName")}));n="/_api/web/Lists/getByTitle('".concat(t,"')/items")}var p=[];return c&&p.push("$expand=".concat(c)),u&&p.push("$filter=".concat(u)),a&&p.push("$select=".concat(a)),p.length&&(n+="?".concat(p.join("&"))),new Promise((function(e,t){r({url:o,endPoint:n}).then((function(t){e(t.d.results)})).catch((function(e){t("GetListItems::".concat(e))}))}))},b=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.allowContentTypes,c=void 0!==s&&s,u=e.baseTemplate,a=void 0===u?100:u,d=e.contentTypesEnabled,l=void 0!==d&&d,f=e.description,m={__metadata:{type:"SP.List"},Title:o,AllowContentTypes:c,BaseTemplate:a,ContentTypesEnabled:l,Description:void 0===f?"":f};return o?(t="/_api/web/Lists",new Promise((function(e,i){r({url:n,endPoint:t,method:"post",body:m}).then((function(t){e(t.d)})).catch((function(e){i("CreateList::".concat(e))}))}))):new Promise((function(e,t){t("CreateList requires listName")}))},I=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID;if(s)t="/_api/web/Lists('".concat(s,"')/recycle");else{if(!o)return new Promise((function(e,t){t("DeleteList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')/recycle")}return new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("DeleteList::".concat(e))}))}))},g=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.items;if(!c)return new Promise((function(e,t){t("AddItemsToList requires items")}));if(Array.isArray(c)||(c=[c]),s)t="/_api/web/Lists('".concat(s,"')/items");else{if(!o)return new Promise((function(e,t){t("AddItemsToList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')/items")}return new Promise((function(e,i){var u=[];v({url:n,listName:o,listGUID:s}).then((function(o){for(var s=0;s<c.length;s++)c[s].__metadata={type:o.ListItemEntityTypeFullName},u.push(r({url:n,endPoint:t,method:"post",body:c[s]}));Promise.all(u).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){i("AddItemsToList::".concat(e))}))}))}))},L=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.itemIds;if(!c)return new Promise((function(e,t){t("RemoveItemsFromList requires items")}));if(Array.isArray(c)||(c=[c]),s)t="/_api/web/Lists('".concat(s,"')/items");else{if(!o)return new Promise((function(e,t){t("RemoveItemsFromList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')/items")}return new Promise((function(e,i){for(var o=[],s=0;s<c.length;s++)o.push(r({url:n,endPoint:"".concat(t,"(").concat(c[s],")/recycle"),method:"post",headers:{"x-http-method":"delete","if-match":"*"}}));Promise.all(o).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){i("RemoveItemsFromList::".concat(e))}))}))},y=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.items;if(!c)return new Promise((function(e,t){t("UpdateListItem requires items")}));Array.isArray(c)||(c=[c]);for(var u=0;u<c.length;u++)if(!c[u].Id)return new Promise((function(e,t){t("UpdateListItem requires item Id")}));if(s)t="/_api/web/Lists('".concat(s,"')/items");else{if(!o)return new Promise((function(e,t){t("UpdateListItem requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')/items")}return new Promise((function(e,i){var u=[];v({url:n,listName:o,listGUID:s}).then((function(o){for(var s=0;s<c.length;s++)c[s].__metadata={type:o.ListItemEntityTypeFullName},u.push(r({url:n,endPoint:"".concat(t,"(").concat(c[s].Id,")"),method:"merge",body:c[s]}));Promise.all(u).then((function(t){e()})).catch((function(e){i("UpdateListItem::".concat(e))}))}))}))},_=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.principalId,u=e.roleDefId;if(!c)return Promise.reject("AddPermissionsToList requires principalId");if(!u)return Promise.reject("AddPermissionsToList requires roleDefId");if(s)t="/_api/web/Lists('".concat(s,"')/RoleAssignments/addRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")");else{if(!o)return Promise.reject("AddPermissionsToList requires listGUID or listName");t="/_api/web/Lists/getByTitle('".concat(o,"')/RoleAssignments/addRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")")}return new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("AddPermissionsToList::".concat(e))}))}))},U=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.principalId,s=e.roleDefId;return o?s?(t="/_api/web/RoleAssignments/addRoleAssignment(principalid=".concat(o,",roledefid=").concat(s,")"),new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("AddPermissionsToSite::".concat(e))}))}))):Promise.reject("AddPermissionsToList requires roleDefId"):Promise.reject("AddPermissionsToList requires principalId")},D=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.copy,u=void 0===c||c,a=e.clear,d=void 0!==a&&a;if(s)t="/_api/web/Lists('".concat(s,"')/breakroleinheritance(copyRoleAssignments=").concat(u,",clearSubscopes=").concat(d,")");else{if(!o)return new Promise((function(e,t){t("BreakInheritanceOnList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')/breakroleinheritance(copyRoleAssignments=").concat(u,",clearSubscopes=").concat(d,")")}return new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("BreakListPermissionsInheritance::".concat(e))}))}))},A=function(e){var t=e.baseurl,i=void 0===t?"":t,n=e.copy,o=void 0===n||n,s=e.clear,c=void 0!==s&&s,u="/_api/web/breakroleinheritance(copyRoleAssignments=".concat(o,",clearSubscopes=").concat(c,")");return new Promise((function(e,t){r({url:i,endPoint:u,method:"post"}).then((function(t){e(t.d)})).catch((function(e){t("BreakSitePermissionsInheritance::".concat(e))}))}))},N=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID;if(s)t="/_api/web/Lists('".concat(s,"')/RoleAssignments").concat("?$expand=RoleDefinitionBindings,Member");else{if(!o)return Promise.reject("GetListPermissions requires listGUID or listName");t="/_api/web/Lists/getByTitle('".concat(o,"')/RoleAssignments").concat("?$expand=RoleDefinitionBindings,Member")}return new Promise((function(e,i){r({url:n,endPoint:t}).then((function(t){e(t.d.results)}))})).catch((function(e){Promise.reject("GetListPermissions::".concat(e))}))},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="?$expand=RoleDefinitionBindings,Member",i="/_api/web/RoleAssignments".concat(t);return new Promise((function(t,n){r({url:e,endPoint:i}).then((function(e){t(e.d.results)})).catch((function(e){n("GetSitePermissions::".concat(e))}))}))},F=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.principalId,u=e.roleDefId;if(!c)return Promise.reject("RemovePermissionsFromList requires principalId");if(!u)return Promise.reject("RemovePermissionsFromList requires roleDefId");if(s)t="/_api/web/Lists('".concat(s,"')/RoleAssignments/removeRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")");else{if(!o)return Promise.reject("RemovePermissionsFromList requires listGUID or listName");t="/_api/web/Lists/getByTitle('".concat(o,"')/RoleAssignments/removeRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")")}return new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("RemovePermissionsFromList::".concat(e))}))}))},R=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.principalId,s=e.roleDefId;return o?s?(t="/_api/web/RoleAssignments/removeRoleAssignment(principalid=".concat(o,",roledefid=").concat(s,")"),new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("RemovePermissionsFromSite::".concat(e))}))}))):Promise.reject("RemovePermissionsFromSite requires roleDefId"):Promise.reject("RemovePermissionsFromSite requires principalId")},S=function(e){var t=e.baseurl,i=void 0===t?"":t;return new Promise((function(e,t){r({url:i,endPoint:"/_api/web/resetroleinheritance",method:"post"}).then((function(t){e(t.d)})).catch((function(e){t("ResetSitePermissionsInheritance::".concat(e))}))}))},T=function(e){var t=e.baseurl,i=void 0===t?"":t,n=e.expand,o=void 0===n?"":n,s="/_api/web",c=[];return o&&c.push("$expand=".concat(o)),c.length&&(s+="?".concat(c.join("&"))),new Promise((function(e,t){r({url:i,endPoint:s}).then((function(t){e(t.d)})).catch((function(e){t("GetSite::".concat(e))}))}))},j=function(e){var t=e.baseurl,i=void 0===t?"":t;return new Promise((function(e,t){r({url:i,endPoint:"/_api/web/RoleDefinitions"}).then((function(t){for(var i={},n=0;n<t.d.results.length;n++)i[t.d.results[n].Name]=t.d.results[n];e(i)})).catch((function(e){t("GetRoleDefinitions::".concat(e))}))}))},V=function(e){var t=e.baseurl,i=void 0===t?"":t,n=e.expand,o="/_api/web/CurrentUser";return n&&(o="".concat(o,"?$expand=").concat(n)),new Promise((function(e,t){r({url:i,endPoint:o}).then((function(t){e(t.d)})).catch((function(e){t("GetCurrentUser::".concat(e))}))}))},x=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.userId;return o?(t="/_api/web/GetUserById(".concat(o,")"),new Promise((function(e,i){r({url:n,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){i("GetUser::".concat(e))}))}))):new Promise((function(e,t){t("GetUser requires userId")}))},B=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.userId;return o?(t="/_api/web/GetUserById(".concat(o,")/Groups"),new Promise((function(e,i){r({url:n,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){i("GetUserGroups::".concat(e))}))}))):new Promise((function(e,t){t("GetUserGroups requires userId")}))},C=function(e){var t=e.baseurl,i=void 0===t?"":t,n=e.query,o=e.properties,s=e.rowlimit,c=void 0===s?100:s,u=e.trimDuplicates,a=void 0!==u&&u,d=e.sort,l=void 0===d?"rank:descending":d;if(!n)return Promise.reject("Search requires query");var f="?querytext='".concat(n,"'&rowlimit=").concat(c,"&trimDuplicates=").concat(a,"&sortlist='").concat(l,"'");o&&(f+="&selectproperties='".concat(o,"'"));var m="/_api/search/query".concat(f);return new Promise((function(e,t){r({url:i,endPoint:m}).then((function(t){e(t.d.query)})).catch((function(e){t("Search::".concat(e))}))}))},$=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.viewGUID,u=e.field;if(s)t="/_api/web/Lists('".concat(s,"')");else{if(!o)return new Promise((function(e,t){t("AddListViewField requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')")}return c?(t="".concat(t,"/Views('").concat(c,"')/ViewFields/addviewfield('").concat(u,"')"),new Promise(u?function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("AddListViewField::".concat(e))}))}:function(e,t){t("AddListViewField requires field")})):new Promise((function(e,t){t("AddListViewField requires viewGUID")}))},k=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID;if(s)t="/_api/web/Lists('".concat(s,"')/DefaultView?$expand=ViewFields");else{if(!o)return new Promise((function(e,t){t("GetListViews requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')/DefaultView?$expand=ViewFields")}return new Promise((function(e,i){r({url:n,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){i("GetListDefaultView::".concat(e))}))}))},E=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.viewGUID;if(s)t="/_api/web/Lists('".concat(s,"')/Views");else{if(!o)return new Promise((function(e,t){t("GetListViews requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')/Views")}return c&&(t="".concat(t,"('").concat(c,"')")),t="".concat(t).concat("?$expand=ViewFields"),new Promise((function(e,i){r({url:n,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){i("GetListViews::".concat(e))}))}))},M=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.viewGUID;if(s)t="/_api/web/Lists('".concat(s,"')");else{if(!o)return new Promise((function(e,t){t("RemoveListViewAllFields requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')")}return c?(t="".concat(t,"/Views('").concat(c,"')/ViewFields/removeallviewfields"),new Promise((function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("RemoveListViewField::".concat(e))}))}))):new Promise((function(e,t){t("RemoveListViewAllFields requires viewGUID")}))},O=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.viewGUID,u=e.field;if(s)t="/_api/web/Lists('".concat(s,"')");else{if(!o)return new Promise((function(e,t){t("RemoveListViewField requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')")}return c?(t="".concat(t,"/Views('").concat(c,"')/ViewFields/removeviewfield('").concat(u,"')"),new Promise(u?function(e,i){r({url:n,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){i("RemoveListViewField::".concat(e))}))}:function(e,t){t("RemoveListViewField requires field")})):new Promise((function(e,t){t("RemoveListViewField requires viewGUID")}))},W=function(e){var t,i=e.baseurl,n=void 0===i?"":i,o=e.listName,s=e.listGUID,c=e.viewGUID,u=e.field,a=e.index,d=void 0===a?0:a;if(s)t="/_api/web/Lists('".concat(s,"')");else{if(!o)return new Promise((function(e,t){t("SetListViewFieldIndex requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(o,"')")}return c?(t="".concat(t,"/Views('").concat(c,"')/ViewFields/moveviewfieldto"),new Promise(u?function(e,i){r({url:n,endPoint:t,method:"post",body:{field:u,index:d}}).then((function(t){e(t.d)})).catch((function(e){i("SetListViewFieldIndex::".concat(e))}))}:function(e,t){t("SetListViewFieldIndex requires field")})):new Promise((function(e,t){t("SetListViewFieldIndex requires viewGUID")}))}}],[[0,1]]]);
//# sourceMappingURL=main.e5393599.chunk.js.map
!function(e){function t(t){for(var n,u,l=t[0],p=t[1],f=t[2],c=0,s=[];c<l.length;c++)u=l[c],Object.prototype.hasOwnProperty.call(o,u)&&o[u]&&s.push(o[u][0]),o[u]=0;for(n in p)Object.prototype.hasOwnProperty.call(p,n)&&(e[n]=p[n]);for(a&&a(t);s.length;)s.shift()();return i.push.apply(i,f||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,l=1;l<r.length;l++){var p=r[l];0!==o[p]&&(n=!1)}n&&(i.splice(t--,1),e=u(u.s=r[0]))}return e}var n={},o={1:0},i=[];function u(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,u),r.l=!0,r.exports}u.m=e,u.c=n,u.d=function(e,t,r){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(u.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)u.d(r,n,function(t){return e[t]}.bind(null,n));return r},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/";var l=this["webpackJsonpcitz-imb-sp-utilities"]=this["webpackJsonpcitz-imb-sp-utilities"]||[],p=l.push.bind(l);l.push=t,l=l.slice();for(var f=0;f<l.length;f++)t(l[f]);var a=p;r()}([]);
//# sourceMappingURL=runtime-main.83952e78.js.map