module.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";n.r(t),n.d(t,"GetContextWebInformation",(function(){return r})),n.d(t,"GetFormDigestValue",(function(){return i})),n.d(t,"SendEmail",(function(){return s})),n.d(t,"AddUsersToGroup",(function(){return c})),n.d(t,"ChangeGroupOwner",(function(){return u})),n.d(t,"CreateGroup",(function(){return a})),n.d(t,"GetAssociatedGroups",(function(){return d})),n.d(t,"GetGroup",(function(){return l})),n.d(t,"GetGroupMembers",(function(){return f})),n.d(t,"RemoveUsersFromGroup",(function(){return m})),n.d(t,"AddItemsToList",(function(){return P})),n.d(t,"CreateList",(function(){return h})),n.d(t,"DeleteList",(function(){return b})),n.d(t,"GetList",(function(){return p})),n.d(t,"GetListDefaultView",(function(){return G})),n.d(t,"GetListFields",(function(){return v})),n.d(t,"GetListItems",(function(){return w})),n.d(t,"GetListViews",(function(){return g})),n.d(t,"RemoveItemsFromList",(function(){return I})),n.d(t,"AddPermissionsToList",(function(){return y})),n.d(t,"AddPermissionsToSite",(function(){return L})),n.d(t,"BreakListPermissionsInheritance",(function(){return _})),n.d(t,"BreakSitePermissionsInheritance",(function(){return A})),n.d(t,"GetListPermissions",(function(){return U})),n.d(t,"GetSitePermissions",(function(){return N})),n.d(t,"RemovePermissionsFromList",(function(){return D})),n.d(t,"RemovePermissionsFromSite",(function(){return j})),n.d(t,"ResetSitePermissionsInheritance",(function(){return S})),n.d(t,"GetSite",(function(){return q})),n.d(t,"GetCurrentUser",(function(){return R})),n.d(t,"GetUser",(function(){return T})),n.d(t,"GetUserGroups",(function(){return B}));var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise((function(t,n){r(e).then((function(e){t(e.FormDigestValue)})).catch((function(e){n("GetFormDigestValue::".concat(e))}))}))},o=function(e){var t=e.url,n=void 0===t?"":t,o=e.endPoint,r=e.method,s=void 0===r?"get":r,c=e.body,u=void 0===c?"":c,a=e.headers,d=function(e,t,n){return new Promise((function(i,o){fetch("".concat(e).concat(t),n).then((function(e){e.ok?i(e.json()):o("".concat(e.status," ").concat(e.statusText))}))}))};if(""===n){if("undefined"==typeof _spPageContextInfo)return Promise.reject("RestCall:: _spPageContextInfo is not defined");n=_spPageContextInfo.webAbsoluteUrl}var l={method:s};return"string"!=typeof u?l.body=JSON.stringify(u):""!==u&&(l.body=u),l.headers=a||{Accept:"application/json;odata=verbose","content-type":"application/json;odata=verbose"},new Promise((function(e,t){"post"===l.method.toLowerCase()?i(n).then((function(i){l.headers["X-RequestDigest"]=i,d(n,o,l).then((function(t){e(t)})).catch((function(e){t(e)}))})):d(n,o,l).then((function(t){e(t)})).catch((function(e){t(e)}))}))},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise((function(t,n){o({url:e,endPoint:"/_api/contextinfo",method:"post"}).then((function(e){t(e.d.GetContextWebInformation)})).catch((function(e){n("GetContextWebInformation::".concat(e))}))}))},s=function(e){var t=e.baseurl,n=void 0===t?"":t,i=e.to,r=e.cc,s=void 0===r?[]:r,c=e.bcc,u=void 0===c?[]:c,a=e.subject,d=e.body;if(!i)return new Promise((function(e,t){t("SendEmail requires to")}));if(!a)return new Promise((function(e,t){t("SendEmail requires subject")}));if(!d)return new Promise((function(e,t){t("SendEmail requires body")}));var l={properties:{__metadata:{type:"SP.Utilities.EmailProperties"},To:{results:i},Body:d,Subject:a,CC:{results:s},BCC:{results:u}}};return new Promise((function(e,t){o({url:n,endPoint:"/_api/SP.Utilities.Utility.SendEmail",method:"post",body:l,headers:headers}).then((function(t){e(t.d)})).catch((function(e){t("SendEmail::".concat(e))}))}))},c=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.groupId,s=e.groupName,c=e.loginName;if(!c)return Promise.reject("AddUsersToGroup requires loginName");if(Array.isArray(c)||(c=[c]),r)t="/_api/web/SiteGroups(".concat(r,")/Users");else{if(!s)return Promise.reject("AddUsersToGroup requires GroupId or GroupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')/Users(").concat(LoginName,")")}return new Promise((function(e,n){for(var r=[],s=0;s<c.length;s++)r.push(o({url:i,endPoint:t,method:"post",body:{__metadata:{type:"SP.User"},LoginName:c[s]},headers:{accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"}}));Promise.all(r).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){n("AddUsersToGroup::".concat(e))}))}))},u=function(e){var t=e.baseurl,n=void 0===t?"":t,i=e.groupId,o=e.groupName,r=e.ownerGroupId,s=e.ownerGroupName;if("undefined"==typeof SP)return Promise.reject("ChangeGroupOwner:: SP is undefined");var c,u,a=new SP.ClientContext(n);if(i)c=a.get_web().get_siteGroups().getById(i);else{if(!o)return Promise.reject("ChangeGroupOwner requires groupId or groupName");c=a.get_web().get_siteGroups().getByName(o)}if(r)u=a.get_web().get_siteGroups().getById(r);else{if(!s)return Promise.reject("ChangeGroupOwner requires ownerGroupId or ownerGroupName");u=a.get_web().get_siteGroups().getByName(s)}return new Promise((function(e,t){c.set_owner(u),c.update(),a.executeQueryAsync((function(){e()}),(function(){t("ChangeGroupOwner::".concat(response))}))}))},a=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.groupName,s=e.groupDescription,c={__metadata:{type:"SP.Group"},Description:void 0===s?"":s,Title:r};return r?(t="/_api/web/SiteGroups",new Promise((function(e,n){o({url:i,endPoint:t,method:"post",body:c,headers:headers}).then((function(t){e(t.d)})).catch((function(e){n("CreateGroup::".concat(e))}))}))):Promise.reject("CreateGroup requires GroupName")},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new Promise((function(t,n){Promise.all([o({url:e,endPoint:"/_api/Web/AssociatedOwnerGroup"}),o({url:e,endPoint:"/_api/Web/AssociatedMemberGroup"}),o({url:e,endPoint:"/_api/Web/AssociatedVisitorGroup"})]).then((function(e){t({AssociatedOwnerGroup:e[0].d,AssociatedMemberGroup:e[1].d,AssociatedVisitorGroup:e[2].d})})).catch((function(e){n("GetAssociatedGroups::".concat(e))}))}))},l=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.groupId,s=e.groupName;if(r)t="/_api/web/SiteGroups(".concat(r,")");else{if(!s)return Promise.reject("GetGroup requires GroupId or GroupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')")}return new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){n("GetGroup::".concat(e))}))}))},f=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.groupId,s=e.groupName;if(r)t="/_api/web/SiteGroups(".concat(r,")/Users");else{if(!s)return Promise.reject("GetGroupMembers requires GroupId or GroupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')/Users")}return new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d.results)})).catch((function(e){n("GetGroupMembers::".concat(e))}))}))},m=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.groupId,s=e.groupName,c=e.loginName,u=e.userId;if(r)t="/_api/web/SiteGroups(".concat(r,")/Users");else{if(!s)return Promise.reject("RemoveUsersFromGroup requires GroupId or GroupName");t="/_api/web/SiteGroups/getByName('".concat(s,"')/Users")}if(c)Array.isArray(c)||(u=[c]);else{if(!u)return Promise.reject("RemoveUserFromGroup requires userId or logonName");Array.isArray(u)||(u=[u])}return new Promise((function(e,n){GetFormDigestValue(i).then((function(r){var s=[];if(c)for(var a=0;a<c.length;a++)s.push(o({url:i,endPoint:"".concat(t,"/removeByLoginName('").concat(c[a],"')"),method:"post",headers:{"x-requestdigest":r,accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"}}));else for(var d=0;d<u.length;d++)s.push(o({url:i,endPoint:"".concat(t,"/removeByID(").concat(u[d],")"),method:"post",headers:{"x-requestdigest":r,accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"}}));Promise.all(s).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){n("RemoveUsersFromGroup::".concat(e))}))}))}))},p=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.expand,u=void 0===c?"":c,a="?$expand=FirstUniqueAncestorSecurableObject,RootFolder";if(u&&(a+=",".concat(u)),s)t="/_api/web/Lists('".concat(s,"')").concat(a);else{if(!r)return Promise.reject("GetList requires listGUID or listName");t="/_api/web/Lists/getByTitle('".concat(r,"')").concat(a)}return new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){n("GetList::".concat(e))}))}))},P=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.items;if(!c)return new Promise((function(e,t){t("AddItemsToList requires items")}));if(Array.isArray(c)||(c=[c]),s)t="/_api/web/Lists('".concat(s,"')/items");else{if(!r)return new Promise((function(e,t){t("AddItemsToList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/items")}return new Promise((function(e,n){var u=[];Promise.all([p({url:i,listName:r,listGUID:s}),GetFormDigestValue()]).then((function(r){for(var s=0;s<c.length;s++)c[s].__metadata={type:r[0].ListItemEntityTypeFullName},u.push(o({url:i,endPoint:t,method:"post",body:c[s],headers:{"x-requestdigest":r[1],accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"}}));Promise.all(u).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){n("AddItemsToList::".concat(e))}))}))}))},h=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.allowContentTypes,c=void 0!==s&&s,u=e.baseTemplate,a=void 0===u?100:u,d=e.contentTypesEnabled,l=void 0!==d&&d,f=e.description,m={__metadata:{type:"SP.List"},Title:r,AllowContentTypes:c,BaseTemplate:a,ContentTypesEnabled:l,Description:void 0===f?"":f};return r?(t="/_api/web/Lists",new Promise((function(e,n){GetFormDigestValue(i).then((function(r){o({url:i,endPoint:t,method:"post",body:m,headers:{"x-requestdigest":r,accept:"application/json; odata=verbose","content-type":"application/json; odata=verbose"}}).then((function(t){e(t.d)})).catch((function(e){n("CreateList::".concat(e))}))}))}))):new Promise((function(e,t){t("CreateList requires listName")}))},b=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID;if(s)t="/_api/web/Lists('".concat(s,"')/recycle");else{if(!r)return new Promise((function(e,t){t("DeleteList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/recycle")}return new Promise((function(e,n){o({url:i,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){n("DeleteList::".concat(e))}))}))},G=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID;if(s)t="/_api/web/Lists('".concat(s,"')/DefaultView?$expand=ViewFields");else{if(!r)return new Promise((function(e,t){t("GetListViews requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/DefaultView?$expand=ViewFields")}return new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){n("GetListDefaultView::".concat(e))}))}))},v=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID;if(s)t="/_api/web/Lists('".concat(s,"')/Fields");else{if(!r)return new Promise((function(e,t){t("GetListFields requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/Fields")}return new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d.results)})).catch((function(e){n("GetListFields::".concat(e))}))}))},w=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.filter,u=e.expand,a=e.select,d=[];if(s)t="/_api/web/Lists('".concat(s,"')/items");else{if(!r)return new Promise((function(e,t){t("GetList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/items")}return a&&d.push("$select=".concat(a)),u&&d.push("$expand=".concat(u)),c&&d.push("$filter=".concat(c)),d.length&&(t+="?".concat(d.join("&"))),new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d.results)})).catch((function(e){n("GetListItems::".concat(e))}))}))},g=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.viewGUID;if(s)t="/_api/web/Lists('".concat(s,"')/Views");else{if(!r)return new Promise((function(e,t){t("GetListViews requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/Views")}return c&&(t="".concat(t,"('").concat(c,"')")),t="".concat(t).concat("?$expand=ViewFields"),new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){n("GetListViews::".concat(e))}))}))},I=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.itemIds;if(!c)return new Promise((function(e,t){t("RemoveItemsFromList requires items")}));if(Array.isArray(c)||(c=[c]),s)t="/_api/web/Lists('".concat(s,"')/items");else{if(!r)return new Promise((function(e,t){t("RemoveItemsFromList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/items")}return new Promise((function(e,n){for(var r=[],s=0;s<c.length;s++)r.push(o({url:i,endPoint:"".concat(t,"(").concat(c[s],")/recycle"),method:"post",headers:{"x-http-method":"delete","if-match":"*"}}));Promise.all(r).then((function(t){e(t.map((function(e){return e.d})))})).catch((function(e){n("RemoveItemsFromList::".concat(e))}))}))},y=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.principalId,u=e.roleDefId;if(!c)return Promise.reject("AddPermissionsToList requires principalId");if(!u)return Promise.reject("AddPermissionsToList requires roleDefId");if(s)t="/_api/web/Lists('".concat(s,"')/RoleAssignments/addRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")");else{if(!r)return Promise.reject("AddPermissionsToList requires listGUID or listName");t="/_api/web/Lists/getByTitle('".concat(r,"')/RoleAssignments/addRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")")}return new Promise((function(e,n){o({url:i,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){n("AddPermissionsToList::".concat(e))}))}))},L=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.principalId,s=e.roleDefId;return r?s?(t="/_api/web/RoleAssignments/addRoleAssignment(principalid=".concat(r,",roledefid=").concat(s,")"),new Promise((function(e,n){o({url:i,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){n("AddPermissionsToSite::".concat(e))}))}))):Promise.reject("AddPermissionsToList requires roleDefId"):Promise.reject("AddPermissionsToList requires principalId")},_=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.copy,u=void 0===c||c,a=e.clear,d=void 0!==a&&a;if(s)t="/_api/web/Lists('".concat(s,"')/breakroleinheritance(copyRoleAssignments=").concat(u,",clearSubscopes=").concat(d,")");else{if(!r)return new Promise((function(e,t){t("BreakInheritanceOnList requires listGUID or listName")}));t="/_api/web/Lists/getByTitle('".concat(r,"')/breakroleinheritance(copyRoleAssignments=").concat(u,",clearSubscopes=").concat(d,")")}return new Promise((function(e,n){o({url:i,endPoint:t,method:"post",headers:headers}).then((function(t){e(t.d)})).catch((function(e){n("BreakListPermissionsInheritance::".concat(e))}))}))},A=function(e){var t=e.baseurl,n=void 0===t?"":t,i=e.copy,r=void 0===i||i,s=e.clear,c=void 0!==s&&s,u="/_api/web/breakroleinheritance(copyRoleAssignments=".concat(r,",clearSubscopes=").concat(c,")");return new Promise((function(e,t){o({url:n,endPoint:u,method:"post",headers:headers}).then((function(t){e(t.d)})).catch((function(e){t("BreakSitePermissionsInheritance::".concat(e))}))}))},U=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID;if(s)t="/_api/web/Lists('".concat(s,"')/RoleAssignments").concat("?$expand=RoleDefinitionBindings,Member");else{if(!r)return Promise.reject("GetListPermissions requires listGUID or listName");t="/_api/web/Lists/getByTitle('".concat(r,"')/RoleAssignments").concat("?$expand=RoleDefinitionBindings,Member")}return new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d.results)}))})).catch((function(e){reject("GetListPermissions::".concat(e))}))},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="?$expand=RoleDefinitionBindings,Member",n="/_api/web/RoleAssignments".concat(t);return new Promise((function(t,i){o({url:e,endPoint:n}).then((function(e){t(e.d.results)})).catch((function(e){i("GetSitePermissions::".concat(e))}))}))},D=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.listName,s=e.listGUID,c=e.principalId,u=e.roleDefId;if(!c)return Promise.reject("RemovePermissionsFromList requires principalId");if(!u)return Promise.reject("RemovePermissionsFromList requires roleDefId");if(s)t="/_api/web/Lists('".concat(s,"')/RoleAssignments/removeRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")");else{if(!r)return Promise.reject("RemovePermissionsFromList requires listGUID or listName");t="/_api/web/Lists/getByTitle('".concat(r,"')/RoleAssignments/removeRoleAssignment(principalid=").concat(c,",roledefid=").concat(u,")")}return new Promise((function(e,n){o({url:i,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){n("RemovePermissionsFromList::".concat(e))}))}))},j=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.principalId,s=e.roleDefId;return r?s?(t="/_api/web/RoleAssignments/removeRoleAssignment(principalid=".concat(r,",roledefid=").concat(s,")"),new Promise((function(e,n){o({url:i,endPoint:t,method:"post"}).then((function(t){e(t.d)})).catch((function(e){n("RemovePermissionsFromSite::".concat(e))}))}))):Promise.reject("RemovePermissionsFromSite requires roleDefId"):Promise.reject("RemovePermissionsFromSite requires principalId")},S=function(e){var t=e.baseurl,n=void 0===t?"":t;return new Promise((function(e,t){o({url:n,endPoint:"/_api/web/resetroleinheritance",method:"post"}).then((function(t){e(t.d)})).catch((function(e){t("ResetSitePermissionsInheritance::".concat(e))}))}))},q=function(e){var t=e.baseurl,n=void 0===t?"":t;console.log("GetSite");var i="/_api/web".concat("?$expand=FirstUniqueAncestorSecurableObject,ParentWeb");return new Promise((function(e,t){o({url:n,endPoint:i}).then((function(t){e(t.d)})).catch((function(e){t("GetSite::".concat(e))}))}))},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="/_api/web/CurrentUser";return new Promise((function(n,i){o({url:e,endPoint:t}).then((function(e){n(e.d)})).catch((function(e){i("GetCurrentUser::".concat(e))}))}))},T=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.userId;return r?(t="/_api/web/GetUserById(".concat(r,")"),new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){n("GetUser::".concat(e))}))}))):new Promise((function(e,t){t("GetUser requires userId")}))},B=function(e){var t,n=e.baseurl,i=void 0===n?"":n,r=e.userId;return r?(t="/_api/web/GetUserById(".concat(r,")/Groups"),new Promise((function(e,n){o({url:i,endPoint:t}).then((function(t){e(t.d)})).catch((function(e){n("GetUserGroups::".concat(e))}))}))):new Promise((function(e,t){t("GetUserGroups requires userId")}))}}]);